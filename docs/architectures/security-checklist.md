# セキュリティチェックリスト

## 🔒 認証・認可
- [ ] 強力なパスワードポリシーの実装
- [ ] 多要素認証（MFA）の導入
- [ ] セッション管理の適切な実装
- [ ] JWT トークンの適切な管理
- [ ] アカウントロックアウト機能
- [ ] パスワードリセット機能のセキュリティ
- [ ] ログイン後のセッションID再発行によるセッション固定攻撃対策
- [ ] OIDC/OAuth の `state`、`nonce`、PKCE の検証
- [ ] ロール／スコープベース認可のサーバー側検証
- [ ] アクセストークン・リフレッシュトークンのローテーションと失効手順

## 🛡️ 入力検証・サニタイゼーション
- [ ] すべての入力値の検証
- [ ] SQLインジェクション対策
- [ ] XSS対策（CSP実装済み）
- [ ] CSRF対策の実装
- [ ] ファイルアップロードの検証
- [ ] パラメータ改ざん対策
- [ ] コマンド／LDAP／XML インジェクション対策
- [ ] 出力エスケープとテンプレートエンジンでの自動サニタイズ設定

## 🔐 暗号化・ハッシュ化
- [ ] パスワードの適切なハッシュ化（bcrypt等）
- [ ] 機密データの暗号化
- [ ] HTTPS通信の強制
- [ ] 通信データの暗号化
- [ ] 鍵管理（KMS 連携、鍵ローテーション、アクセス制御）

## 🌐 ネットワークセキュリティ
- [ ] セキュリティヘッダーの設定
- [ ] CORS設定の適切な実装
- [ ] レート制限の実装
- [ ] DDoS対策
- [ ] ファイアウォール設定
- [ ] ゼロトラスト／セグメント単位でのアクセス制御

## 📊 ログ・監視
- [ ] セキュリティイベントのログ記録
- [ ] 異常なアクセスパターンの検知
- [ ] ログの改ざん防止
- [ ] 監査ログの実装
- [ ] リアルタイム監視
- [ ] ログ出力時の個人情報・シークレットのマスキング

## 🗄️ データベースセキュリティ
- [ ] データベース接続の暗号化
- [ ] 最小権限の原則
- [ ] データベースの定期バックアップ
- [ ] 機密データの暗号化
- [ ] SQLインジェクション対策
- [ ] 行レベル／カラムレベルのアクセス制御
- [ ] ストアドプロシージャや OR/M でのパラメータバインディング徹底

## 🐳 インフラストラクチャセキュリティ
- [ ] コンテナのセキュリティ設定
- [ ] イメージの脆弱性スキャン
- [ ] 最小権限でのコンテナ実行
- [ ] シークレット管理
- [ ] ネットワーク分離
- [ ] ベースイメージの署名検証とイミュータブルタグ運用

## 🔄 依存関係管理
- [ ] 定期的な依存関係の更新
- [ ] 脆弱性スキャンの自動化
- [ ] セキュリティパッチの迅速な適用
- [ ] サプライチェーン攻撃対策
- [ ] SBOM（Software Bill of Materials）の生成と保管

## 🚨 インシデント対応
- [ ] インシデント対応計画の策定
- [ ] セキュリティ侵害の早期検知
- [ ] 復旧手順の文書化
- [ ] 事後分析の実施
- [ ] 連絡経路・エスカレーションルールの定義（ホットライン）

## 📋 コンプライアンス
- [ ] GDPR対応（該当する場合）
- [ ] 個人情報保護法対応
- [ ] 業界固有の規制対応
- [ ] セキュリティ監査の実施
- [ ] 監査証跡と保存ポリシーの整備

## 🛠️ 開発プロセス
- [ ] セキュアコーディングガイドラインの策定
- [ ] コードレビューでのセキュリティチェック
- [ ] 静的解析ツールの導入
- [ ] ペネトレーションテストの実施
- [ ] 脅威モデリング／セキュリティアーキテクチャレビューの実施

## ⚙️ 設定管理
- [ ] 本番環境での適切な設定
- [ ] 秘密情報の環境変数化
- [ ] デフォルトパスワードの変更
- [ ] 不要なサービスの無効化
- [ ] IaC での設定ドリフト検知とレビュー

## 📚 教育・トレーニング
- [ ] 開発チームのセキュリティ教育
- [ ] 最新の脅威情報の共有
- [ ] セキュリティベストプラクティスの普及
- [ ] 定期的なセキュリティ研修
- [ ] フィッシング訓練や机上演習による実践的トレーニング
