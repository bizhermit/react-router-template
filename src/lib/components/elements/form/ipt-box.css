@layer components {

  ._ipt-box {
    -webkit-appearance: none;
    appearance: none;
    outline: none;
    background-color: transparent;
    padding-inline: var(--spacing-input-pad-x);
    width: 100%;

    &:disabled {
      &::placeholder {
        opacity: 0;
      }
    }

    &:not([type="date"], [type="month"], [type="time"], [type="datetime-local"]) {
      &::-webkit-calendar-picker-indicator {
        display: none !important;
      }
    }
  }

  ._ipt-outer-spin-button {
    position: absolute;
    right: 0;
    z-index: 1;
    width: var(--spacing-input-btn);
    height: 100%;
    display: flex;
    flex-flow: column nowrap;
  }

  ._ipt-inner-spin-button {
    width: 100%;
    flex: 1 1 0rem;
    display: grid;
    justify-content: center;
    touch-action: none;
    -webkit-touch-callout: none;
    user-select: none;

    >._icon {
      width: 0.6rem;
    }
  }

  ._ipt-date {
    &[data-controlled="true"] {
      &[data-hasvalue="false"]:not(:focus) {
        color: var(--color-placeholder);
      }

      &:disabled[aria-disabled="true"] {
        &[data-hasvalue="false"] {
          color: transparent;
        }
      }
    }
  }

  ._ipt-select {
    z-index: 1;
    padding-right: var(--spacing-input-pad-btn);

    &:enabled {
      cursor: pointer;
    }

    &+._ipt-placeholder {
      display: none;
    }

    &:has(option[value=""][data-notext="true"]:checked) {
      &+._ipt-placeholder {
        display: flex;
      }
    }

    &:open {
      &~._ipt-btn {
        transform: rotateX(180deg);
      }
    }

    option {
      border-radius: none;
      background-color: var(--color-input-bg);
    }
  }

  ._ipt-combox-box {
    flex-flow: column nowrap;

    &:focus-within {
      &:has(._ipt-combo-text:not(:disabled, [aria-readonly="true"])) {
        >._ipt-btn {
          transform: rotateX(180deg);
        }

        >._ipt-combo-picker {
          z-index: 100;
          position: fixed;
          position-area: bottom center;
          position-try-fallbacks: top;
          width: anchor-size(width);
          filter: drop-shadow(0 0 3px var(--color-shadow));
          pointer-events: all;

          >._ipt-combo-list {
            justify-content: flex-start;
            max-height: calc(50dvh - var(--spacing-input));
            overflow: auto;
            background: var(--color-input-bg);
            padding-block: 0;
            filter: drop-shadow(0 0 3px var(--color-shadow));

            >._ipt-combo-item {
              cursor: pointer;
              min-height: var(--spacing-input);
              height: unset;

              &[aria-hidden="true"] {
                min-height: 0;
                height: 0;
              }

              &:has(._ipt-combo-item-check:checked) {
                background: var(--color-active);
              }

              >._ipt-combo-item-label {
                align-items: center;
                padding-right: var(--spacing-input-pad-x);
              }
            }
          }
        }
      }
    }

    &:not(:focus-within) {
      >._ipt-combo-dummy {
        max-height: 0;
      }
    }

    &:has(._ipt-combo-item-check:checked) {
      >._ipt-combo-text {
        &::placeholder {
          opacity: 0;
        }
      }
    }
  }

  ._ipt-combo-text {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    padding-right: var(--spacing-input-pad-btn);
  }

  ._ipt-combo-dummy {
    display: flex;
    flex-flow: column nowrap;
    justify-content: flex-start;
    align-items: flex-start;
    opacity: 0;
    visibility: hidden;
    user-select: none;
  }

  ._ipt-combo-picker {
    position: relative;
    min-height: var(--spacing-input);
    overflow: hidden;
    width: fit-content;
    pointer-events: none;
  }

  ._ipt-combo-list {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
    color: var(--color-input);
    background: transparent;
    overscroll-behavior: contain;
    border-radius: var(--radius-input);
    display: flex;
    flex-flow: column nowrap;
    justify-content: center;
    align-items: stretch;
    padding-block: var(--spacing-input-pad-y);
  }

  ._ipt-combo-item {
    position: relative;
    display: flex;
    flex-flow: row nowrap;
    justify-content: flex-start;
    align-items: center;
    height: 0;

    &:is(:focus-within, :has(input:enabled:active)) {
      outline: 2px solid;
      outline-offset: -2px;
      border-radius: var(--radius-input);
    }

    &:has(._ipt-combo-item-check:checked) {
      height: unset;
    }
  }

  ._ipt-combo-item-check {
    appearance: none;
    position: absolute;
    inset: 0;
    opacity: 0;
    pointer-events: none;
  }

  ._ipt-combo-item-label {
    flex: 1 1 0;
    min-width: 0;
    height: 100%;
    display: flex;
    flex-flow: row nowrap;
    justify-content: flex-start;
    align-items: stretch;
    white-space: nowrap;
    overflow: hidden;
    gap: 0.6rem;
    padding-inline: var(--spacing-input-pad-x) var(--spacing-input-pad-btn);
  }

  ._ipt-file {
    position: relative;
    width: 100%;
    height: 100%;
    min-height: 100%;
    z-index: 1;
    padding-inline: var(--spacing-input-pad-x);
    line-height: calc(var(--spacing-input) - 2px);
    background-color: transparent;
    user-select: none;

    &::file-selector-button {
      display: none;
    }
  }

}